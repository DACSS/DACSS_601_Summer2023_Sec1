{
  "hash": "67f332547da052e541676e9261ecaa36",
  "result": {
    "markdown": "---\ntitle: \"Challenge 8 \"\nauthor: \"Zhongyue Lin\"\ndescription: \"Joining Data\"\ndate: \"6/19/2023\"\nformat:\n  html:\n    df-print: paged\n    toc: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - challenge_8\n  - railroads\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(readxl)\nlibrary(scales)\n\n\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\n## Challenge Overview\n\nToday's challenge is to:\n\n1)  read in multiple data sets, and describe the data set using both words and any supporting information (e.g., tables, etc)\n2)  tidy data (as needed, including sanity checks)\n3)  mutate variables as needed (including sanity checks)\n4)  join two or more data sets and analyze some aspect of the joined data\n\n(be sure to only include the category tags for the data you use!)\n\n## Read in data & Tidy Data\n\nRead in one (or more) of the following datasets, using the correct R package and command.\n  - railroads  ⭐⭐⭐\n  \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read the file, skipping the first 3 rows and specifying column names, then remove all columns that are completely empty, then replace NA values in the \"COUNTY\" column with \"/\" when \"STATE\" contains \"Total\"\ndata_clean <- read_excel(\"_data/StateCounty2012.xls\", skip = 3) %>%\n  select_if(~!all(is.na(.))) %>%\n  mutate(COUNTY = ifelse(is.na(COUNTY) & grepl(\"Total\", STATE), \"/\", COUNTY))\n\n# Print out the first few lines of the cleaned data\nhead(data_clean,100)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"STATE\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"COUNTY\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"TOTAL\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"AE\",\"2\":\"APO\",\"3\":\"2\"},{\"1\":\"AE Total1\",\"2\":\"/\",\"3\":\"2\"},{\"1\":\"AK\",\"2\":\"ANCHORAGE\",\"3\":\"7\"},{\"1\":\"AK\",\"2\":\"FAIRBANKS NORTH STAR\",\"3\":\"2\"},{\"1\":\"AK\",\"2\":\"JUNEAU\",\"3\":\"3\"},{\"1\":\"AK\",\"2\":\"MATANUSKA-SUSITNA\",\"3\":\"2\"},{\"1\":\"AK\",\"2\":\"SITKA\",\"3\":\"1\"},{\"1\":\"AK\",\"2\":\"SKAGWAY MUNICIPALITY\",\"3\":\"88\"},{\"1\":\"AK Total\",\"2\":\"/\",\"3\":\"103\"},{\"1\":\"AL\",\"2\":\"AUTAUGA\",\"3\":\"102\"},{\"1\":\"AL\",\"2\":\"BALDWIN\",\"3\":\"143\"},{\"1\":\"AL\",\"2\":\"BARBOUR\",\"3\":\"1\"},{\"1\":\"AL\",\"2\":\"BIBB\",\"3\":\"25\"},{\"1\":\"AL\",\"2\":\"BLOUNT\",\"3\":\"154\"},{\"1\":\"AL\",\"2\":\"BULLOCK\",\"3\":\"13\"},{\"1\":\"AL\",\"2\":\"BUTLER\",\"3\":\"29\"},{\"1\":\"AL\",\"2\":\"CALHOUN\",\"3\":\"45\"},{\"1\":\"AL\",\"2\":\"CHAMBERS\",\"3\":\"13\"},{\"1\":\"AL\",\"2\":\"CHEROKEE\",\"3\":\"9\"},{\"1\":\"AL\",\"2\":\"CHILTON\",\"3\":\"72\"},{\"1\":\"AL\",\"2\":\"CHOCTAW\",\"3\":\"7\"},{\"1\":\"AL\",\"2\":\"CLARKE\",\"3\":\"26\"},{\"1\":\"AL\",\"2\":\"CLAY\",\"3\":\"10\"},{\"1\":\"AL\",\"2\":\"CLEBURNE\",\"3\":\"7\"},{\"1\":\"AL\",\"2\":\"COFFEE\",\"3\":\"14\"},{\"1\":\"AL\",\"2\":\"COLBERT\",\"3\":\"199\"},{\"1\":\"AL\",\"2\":\"CONECUH\",\"3\":\"11\"},{\"1\":\"AL\",\"2\":\"COOSA\",\"3\":\"5\"},{\"1\":\"AL\",\"2\":\"COVINGTON\",\"3\":\"12\"},{\"1\":\"AL\",\"2\":\"CRENSHAW\",\"3\":\"5\"},{\"1\":\"AL\",\"2\":\"CULLMAN\",\"3\":\"129\"},{\"1\":\"AL\",\"2\":\"DALE\",\"3\":\"11\"},{\"1\":\"AL\",\"2\":\"DALLAS\",\"3\":\"122\"},{\"1\":\"AL\",\"2\":\"DEKALB\",\"3\":\"33\"},{\"1\":\"AL\",\"2\":\"ELMORE\",\"3\":\"116\"},{\"1\":\"AL\",\"2\":\"ESCAMBIA\",\"3\":\"47\"},{\"1\":\"AL\",\"2\":\"ETOWAH\",\"3\":\"78\"},{\"1\":\"AL\",\"2\":\"FAYETTE\",\"3\":\"3\"},{\"1\":\"AL\",\"2\":\"FRANKLIN\",\"3\":\"40\"},{\"1\":\"AL\",\"2\":\"GENEVA\",\"3\":\"8\"},{\"1\":\"AL\",\"2\":\"GREENE\",\"3\":\"7\"},{\"1\":\"AL\",\"2\":\"HALE\",\"3\":\"8\"},{\"1\":\"AL\",\"2\":\"HENRY\",\"3\":\"1\"},{\"1\":\"AL\",\"2\":\"HOUSTON\",\"3\":\"46\"},{\"1\":\"AL\",\"2\":\"JACKSON\",\"3\":\"55\"},{\"1\":\"AL\",\"2\":\"JEFFERSON\",\"3\":\"990\"},{\"1\":\"AL\",\"2\":\"LAMAR\",\"3\":\"25\"},{\"1\":\"AL\",\"2\":\"LAUDERDALE\",\"3\":\"117\"},{\"1\":\"AL\",\"2\":\"LAWRENCE\",\"3\":\"11\"},{\"1\":\"AL\",\"2\":\"LEE\",\"3\":\"46\"},{\"1\":\"AL\",\"2\":\"LIMESTONE\",\"3\":\"7\"},{\"1\":\"AL\",\"2\":\"LOWNDES\",\"3\":\"7\"},{\"1\":\"AL\",\"2\":\"MACON\",\"3\":\"6\"},{\"1\":\"AL\",\"2\":\"MADISON\",\"3\":\"29\"},{\"1\":\"AL\",\"2\":\"MARENGO\",\"3\":\"16\"},{\"1\":\"AL\",\"2\":\"MARION\",\"3\":\"17\"},{\"1\":\"AL\",\"2\":\"MARSHALL\",\"3\":\"29\"},{\"1\":\"AL\",\"2\":\"MOBILE\",\"3\":\"331\"},{\"1\":\"AL\",\"2\":\"MONROE\",\"3\":\"43\"},{\"1\":\"AL\",\"2\":\"MONTGOMERY\",\"3\":\"102\"},{\"1\":\"AL\",\"2\":\"MORGAN\",\"3\":\"42\"},{\"1\":\"AL\",\"2\":\"PERRY\",\"3\":\"4\"},{\"1\":\"AL\",\"2\":\"PICKENS\",\"3\":\"24\"},{\"1\":\"AL\",\"2\":\"PIKE\",\"3\":\"19\"},{\"1\":\"AL\",\"2\":\"RANDOLPH\",\"3\":\"39\"},{\"1\":\"AL\",\"2\":\"RUSSELL\",\"3\":\"38\"},{\"1\":\"AL\",\"2\":\"SHELBY\",\"3\":\"158\"},{\"1\":\"AL\",\"2\":\"ST CLAIR\",\"3\":\"162\"},{\"1\":\"AL\",\"2\":\"SUMTER\",\"3\":\"9\"},{\"1\":\"AL\",\"2\":\"TALLADEGA\",\"3\":\"42\"},{\"1\":\"AL\",\"2\":\"TALLAPOOSA\",\"3\":\"19\"},{\"1\":\"AL\",\"2\":\"TUSCALOOSA\",\"3\":\"60\"},{\"1\":\"AL\",\"2\":\"WALKER\",\"3\":\"192\"},{\"1\":\"AL\",\"2\":\"WASHINGTON\",\"3\":\"11\"},{\"1\":\"AL\",\"2\":\"WILCOX\",\"3\":\"11\"},{\"1\":\"AL\",\"2\":\"WINSTON\",\"3\":\"45\"},{\"1\":\"AL Total\",\"2\":\"/\",\"3\":\"4257\"},{\"1\":\"AP\",\"2\":\"APO\",\"3\":\"1\"},{\"1\":\"AP Total1\",\"2\":\"/\",\"3\":\"1\"},{\"1\":\"AR\",\"2\":\"ARKANSAS\",\"3\":\"11\"},{\"1\":\"AR\",\"2\":\"ASHLEY\",\"3\":\"18\"},{\"1\":\"AR\",\"2\":\"BAXTER\",\"3\":\"25\"},{\"1\":\"AR\",\"2\":\"BENTON\",\"3\":\"35\"},{\"1\":\"AR\",\"2\":\"BOONE\",\"3\":\"5\"},{\"1\":\"AR\",\"2\":\"BRADLEY\",\"3\":\"8\"},{\"1\":\"AR\",\"2\":\"CALHOUN\",\"3\":\"5\"},{\"1\":\"AR\",\"2\":\"CHICOT\",\"3\":\"3\"},{\"1\":\"AR\",\"2\":\"CLARK\",\"3\":\"40\"},{\"1\":\"AR\",\"2\":\"CLAY\",\"3\":\"13\"},{\"1\":\"AR\",\"2\":\"CLEBURNE\",\"3\":\"8\"},{\"1\":\"AR\",\"2\":\"CLEVELAND\",\"3\":\"79\"},{\"1\":\"AR\",\"2\":\"COLUMBIA\",\"3\":\"5\"},{\"1\":\"AR\",\"2\":\"CONWAY\",\"3\":\"19\"},{\"1\":\"AR\",\"2\":\"CRAIGHEAD\",\"3\":\"61\"},{\"1\":\"AR\",\"2\":\"CRAWFORD\",\"3\":\"55\"},{\"1\":\"AR\",\"2\":\"CRITTENDEN\",\"3\":\"48\"},{\"1\":\"AR\",\"2\":\"CROSS\",\"3\":\"30\"},{\"1\":\"AR\",\"2\":\"DALLAS\",\"3\":\"12\"},{\"1\":\"AR\",\"2\":\"DESHA\",\"3\":\"15\"},{\"1\":\"AR\",\"2\":\"DREW\",\"3\":\"34\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# Identify the rows where \"STATE\" is \"CANADA\" and replace NA values in \"COUNTY\" with \"Canada\", then remove empty rows above the \"CANADA\" row\ndata_clean <- data_clean %>%\n  mutate(COUNTY = replace(COUNTY, STATE == \"CANADA\", \"Canada\")) %>%\n  slice(1:(nrow(.)-4))\n\n# Print out the last few lines of the cleaned data to check\ntail(data_clean,100)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"STATE\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"COUNTY\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"TOTAL\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"WI\",\"2\":\"ROCK\",\"3\":\"138\"},{\"1\":\"WI\",\"2\":\"RUSK\",\"3\":\"21\"},{\"1\":\"WI\",\"2\":\"SAUK\",\"3\":\"29\"},{\"1\":\"WI\",\"2\":\"SAWYER\",\"3\":\"14\"},{\"1\":\"WI\",\"2\":\"SHAWANO\",\"3\":\"9\"},{\"1\":\"WI\",\"2\":\"SHEBOYGAN\",\"3\":\"9\"},{\"1\":\"WI\",\"2\":\"ST CROIX\",\"3\":\"168\"},{\"1\":\"WI\",\"2\":\"TAYLOR\",\"3\":\"15\"},{\"1\":\"WI\",\"2\":\"TREMPEALEAU\",\"3\":\"54\"},{\"1\":\"WI\",\"2\":\"VERNON\",\"3\":\"48\"},{\"1\":\"WI\",\"2\":\"VILAS\",\"3\":\"5\"},{\"1\":\"WI\",\"2\":\"WALWORTH\",\"3\":\"47\"},{\"1\":\"WI\",\"2\":\"WASHBURN\",\"3\":\"23\"},{\"1\":\"WI\",\"2\":\"WASHINGTON\",\"3\":\"37\"},{\"1\":\"WI\",\"2\":\"WAUKESHA\",\"3\":\"96\"},{\"1\":\"WI\",\"2\":\"WAUPACA\",\"3\":\"34\"},{\"1\":\"WI\",\"2\":\"WAUSHARA\",\"3\":\"13\"},{\"1\":\"WI\",\"2\":\"WINNEBAGO\",\"3\":\"95\"},{\"1\":\"WI\",\"2\":\"WOOD\",\"3\":\"119\"},{\"1\":\"WI Total\",\"2\":\"/\",\"3\":\"3773\"},{\"1\":\"WV\",\"2\":\"BARBOUR\",\"3\":\"33\"},{\"1\":\"WV\",\"2\":\"BERKELEY\",\"3\":\"108\"},{\"1\":\"WV\",\"2\":\"BOONE\",\"3\":\"50\"},{\"1\":\"WV\",\"2\":\"BRAXTON\",\"3\":\"22\"},{\"1\":\"WV\",\"2\":\"BROOKE\",\"3\":\"19\"},{\"1\":\"WV\",\"2\":\"CABELL\",\"3\":\"406\"},{\"1\":\"WV\",\"2\":\"CLAY\",\"3\":\"4\"},{\"1\":\"WV\",\"2\":\"DODDRIDGE\",\"3\":\"4\"},{\"1\":\"WV\",\"2\":\"FAYETTE\",\"3\":\"30\"},{\"1\":\"WV\",\"2\":\"GILMER\",\"3\":\"1\"},{\"1\":\"WV\",\"2\":\"GRANT\",\"3\":\"7\"},{\"1\":\"WV\",\"2\":\"GREENBRIER\",\"3\":\"75\"},{\"1\":\"WV\",\"2\":\"HAMPSHIRE\",\"3\":\"37\"},{\"1\":\"WV\",\"2\":\"HANCOCK\",\"3\":\"37\"},{\"1\":\"WV\",\"2\":\"HARDY\",\"3\":\"7\"},{\"1\":\"WV\",\"2\":\"HARRISON\",\"3\":\"51\"},{\"1\":\"WV\",\"2\":\"JACKSON\",\"3\":\"22\"},{\"1\":\"WV\",\"2\":\"JEFFERSON\",\"3\":\"56\"},{\"1\":\"WV\",\"2\":\"KANAWHA\",\"3\":\"130\"},{\"1\":\"WV\",\"2\":\"LEWIS\",\"3\":\"3\"},{\"1\":\"WV\",\"2\":\"LINCOLN\",\"3\":\"107\"},{\"1\":\"WV\",\"2\":\"LOGAN\",\"3\":\"61\"},{\"1\":\"WV\",\"2\":\"MARION\",\"3\":\"16\"},{\"1\":\"WV\",\"2\":\"MARSHALL\",\"3\":\"26\"},{\"1\":\"WV\",\"2\":\"MASON\",\"3\":\"34\"},{\"1\":\"WV\",\"2\":\"MCDOWELL\",\"3\":\"43\"},{\"1\":\"WV\",\"2\":\"MERCER\",\"3\":\"387\"},{\"1\":\"WV\",\"2\":\"MINERAL\",\"3\":\"223\"},{\"1\":\"WV\",\"2\":\"MINGO\",\"3\":\"168\"},{\"1\":\"WV\",\"2\":\"MONONGALIA\",\"3\":\"19\"},{\"1\":\"WV\",\"2\":\"MONROE\",\"3\":\"35\"},{\"1\":\"WV\",\"2\":\"MORGAN\",\"3\":\"33\"},{\"1\":\"WV\",\"2\":\"NICHOLAS\",\"3\":\"6\"},{\"1\":\"WV\",\"2\":\"OHIO\",\"3\":\"25\"},{\"1\":\"WV\",\"2\":\"PLEASANTS\",\"3\":\"3\"},{\"1\":\"WV\",\"2\":\"POCAHONTAS\",\"3\":\"13\"},{\"1\":\"WV\",\"2\":\"PRESTON\",\"3\":\"35\"},{\"1\":\"WV\",\"2\":\"PUTNAM\",\"3\":\"83\"},{\"1\":\"WV\",\"2\":\"RALEIGH\",\"3\":\"98\"},{\"1\":\"WV\",\"2\":\"RANDOLPH\",\"3\":\"21\"},{\"1\":\"WV\",\"2\":\"RITCHIE\",\"3\":\"7\"},{\"1\":\"WV\",\"2\":\"ROANE\",\"3\":\"3\"},{\"1\":\"WV\",\"2\":\"SUMMERS\",\"3\":\"153\"},{\"1\":\"WV\",\"2\":\"TAYLOR\",\"3\":\"94\"},{\"1\":\"WV\",\"2\":\"TUCKER\",\"3\":\"2\"},{\"1\":\"WV\",\"2\":\"TYLER\",\"3\":\"2\"},{\"1\":\"WV\",\"2\":\"UPSHUR\",\"3\":\"5\"},{\"1\":\"WV\",\"2\":\"WAYNE\",\"3\":\"217\"},{\"1\":\"WV\",\"2\":\"WEBSTER\",\"3\":\"5\"},{\"1\":\"WV\",\"2\":\"WETZEL\",\"3\":\"9\"},{\"1\":\"WV\",\"2\":\"WIRT\",\"3\":\"7\"},{\"1\":\"WV\",\"2\":\"WOOD\",\"3\":\"108\"},{\"1\":\"WV\",\"2\":\"WYOMING\",\"3\":\"63\"},{\"1\":\"WV Total\",\"2\":\"/\",\"3\":\"3213\"},{\"1\":\"WY\",\"2\":\"ALBANY\",\"3\":\"90\"},{\"1\":\"WY\",\"2\":\"BIG HORN\",\"3\":\"70\"},{\"1\":\"WY\",\"2\":\"CAMPBELL\",\"3\":\"386\"},{\"1\":\"WY\",\"2\":\"CARBON\",\"3\":\"168\"},{\"1\":\"WY\",\"2\":\"CONVERSE\",\"3\":\"211\"},{\"1\":\"WY\",\"2\":\"CROOK\",\"3\":\"33\"},{\"1\":\"WY\",\"2\":\"FREMONT\",\"3\":\"42\"},{\"1\":\"WY\",\"2\":\"GOSHEN\",\"3\":\"244\"},{\"1\":\"WY\",\"2\":\"HOT SPRINGS\",\"3\":\"4\"},{\"1\":\"WY\",\"2\":\"JOHNSON\",\"3\":\"18\"},{\"1\":\"WY\",\"2\":\"LARAMIE\",\"3\":\"737\"},{\"1\":\"WY\",\"2\":\"LINCOLN\",\"3\":\"25\"},{\"1\":\"WY\",\"2\":\"NATRONA\",\"3\":\"92\"},{\"1\":\"WY\",\"2\":\"NIOBRARA\",\"3\":\"51\"},{\"1\":\"WY\",\"2\":\"PARK\",\"3\":\"29\"},{\"1\":\"WY\",\"2\":\"PLATTE\",\"3\":\"129\"},{\"1\":\"WY\",\"2\":\"SHERIDAN\",\"3\":\"252\"},{\"1\":\"WY\",\"2\":\"SUBLETTE\",\"3\":\"3\"},{\"1\":\"WY\",\"2\":\"SWEETWATER\",\"3\":\"196\"},{\"1\":\"WY\",\"2\":\"UINTA\",\"3\":\"49\"},{\"1\":\"WY\",\"2\":\"WASHAKIE\",\"3\":\"10\"},{\"1\":\"WY\",\"2\":\"WESTON\",\"3\":\"37\"},{\"1\":\"WY Total\",\"2\":\"/\",\"3\":\"2876\"},{\"1\":\"Grand Total\",\"2\":\"/\",\"3\":\"255432\"},{\"1\":\"NA\",\"2\":\"NA\",\"3\":\"NA\"},{\"1\":\"CANADA\",\"2\":\"Canada\",\"3\":\"662\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# Remove the row before the \"CANADA\" row\ndata_clean <- data_clean %>%\n  slice(-which(.$STATE == \"CANADA\") + 1)\n\n# Print out the last few lines of the cleaned data to check\ntail(data_clean,100)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"STATE\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"COUNTY\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"TOTAL\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"WI\",\"2\":\"RACINE\",\"3\":\"100\"},{\"1\":\"WI\",\"2\":\"ROCK\",\"3\":\"138\"},{\"1\":\"WI\",\"2\":\"RUSK\",\"3\":\"21\"},{\"1\":\"WI\",\"2\":\"SAUK\",\"3\":\"29\"},{\"1\":\"WI\",\"2\":\"SAWYER\",\"3\":\"14\"},{\"1\":\"WI\",\"2\":\"SHAWANO\",\"3\":\"9\"},{\"1\":\"WI\",\"2\":\"SHEBOYGAN\",\"3\":\"9\"},{\"1\":\"WI\",\"2\":\"ST CROIX\",\"3\":\"168\"},{\"1\":\"WI\",\"2\":\"TAYLOR\",\"3\":\"15\"},{\"1\":\"WI\",\"2\":\"TREMPEALEAU\",\"3\":\"54\"},{\"1\":\"WI\",\"2\":\"VERNON\",\"3\":\"48\"},{\"1\":\"WI\",\"2\":\"VILAS\",\"3\":\"5\"},{\"1\":\"WI\",\"2\":\"WALWORTH\",\"3\":\"47\"},{\"1\":\"WI\",\"2\":\"WASHBURN\",\"3\":\"23\"},{\"1\":\"WI\",\"2\":\"WASHINGTON\",\"3\":\"37\"},{\"1\":\"WI\",\"2\":\"WAUKESHA\",\"3\":\"96\"},{\"1\":\"WI\",\"2\":\"WAUPACA\",\"3\":\"34\"},{\"1\":\"WI\",\"2\":\"WAUSHARA\",\"3\":\"13\"},{\"1\":\"WI\",\"2\":\"WINNEBAGO\",\"3\":\"95\"},{\"1\":\"WI\",\"2\":\"WOOD\",\"3\":\"119\"},{\"1\":\"WI Total\",\"2\":\"/\",\"3\":\"3773\"},{\"1\":\"WV\",\"2\":\"BARBOUR\",\"3\":\"33\"},{\"1\":\"WV\",\"2\":\"BERKELEY\",\"3\":\"108\"},{\"1\":\"WV\",\"2\":\"BOONE\",\"3\":\"50\"},{\"1\":\"WV\",\"2\":\"BRAXTON\",\"3\":\"22\"},{\"1\":\"WV\",\"2\":\"BROOKE\",\"3\":\"19\"},{\"1\":\"WV\",\"2\":\"CABELL\",\"3\":\"406\"},{\"1\":\"WV\",\"2\":\"CLAY\",\"3\":\"4\"},{\"1\":\"WV\",\"2\":\"DODDRIDGE\",\"3\":\"4\"},{\"1\":\"WV\",\"2\":\"FAYETTE\",\"3\":\"30\"},{\"1\":\"WV\",\"2\":\"GILMER\",\"3\":\"1\"},{\"1\":\"WV\",\"2\":\"GRANT\",\"3\":\"7\"},{\"1\":\"WV\",\"2\":\"GREENBRIER\",\"3\":\"75\"},{\"1\":\"WV\",\"2\":\"HAMPSHIRE\",\"3\":\"37\"},{\"1\":\"WV\",\"2\":\"HANCOCK\",\"3\":\"37\"},{\"1\":\"WV\",\"2\":\"HARDY\",\"3\":\"7\"},{\"1\":\"WV\",\"2\":\"HARRISON\",\"3\":\"51\"},{\"1\":\"WV\",\"2\":\"JACKSON\",\"3\":\"22\"},{\"1\":\"WV\",\"2\":\"JEFFERSON\",\"3\":\"56\"},{\"1\":\"WV\",\"2\":\"KANAWHA\",\"3\":\"130\"},{\"1\":\"WV\",\"2\":\"LEWIS\",\"3\":\"3\"},{\"1\":\"WV\",\"2\":\"LINCOLN\",\"3\":\"107\"},{\"1\":\"WV\",\"2\":\"LOGAN\",\"3\":\"61\"},{\"1\":\"WV\",\"2\":\"MARION\",\"3\":\"16\"},{\"1\":\"WV\",\"2\":\"MARSHALL\",\"3\":\"26\"},{\"1\":\"WV\",\"2\":\"MASON\",\"3\":\"34\"},{\"1\":\"WV\",\"2\":\"MCDOWELL\",\"3\":\"43\"},{\"1\":\"WV\",\"2\":\"MERCER\",\"3\":\"387\"},{\"1\":\"WV\",\"2\":\"MINERAL\",\"3\":\"223\"},{\"1\":\"WV\",\"2\":\"MINGO\",\"3\":\"168\"},{\"1\":\"WV\",\"2\":\"MONONGALIA\",\"3\":\"19\"},{\"1\":\"WV\",\"2\":\"MONROE\",\"3\":\"35\"},{\"1\":\"WV\",\"2\":\"MORGAN\",\"3\":\"33\"},{\"1\":\"WV\",\"2\":\"NICHOLAS\",\"3\":\"6\"},{\"1\":\"WV\",\"2\":\"OHIO\",\"3\":\"25\"},{\"1\":\"WV\",\"2\":\"PLEASANTS\",\"3\":\"3\"},{\"1\":\"WV\",\"2\":\"POCAHONTAS\",\"3\":\"13\"},{\"1\":\"WV\",\"2\":\"PRESTON\",\"3\":\"35\"},{\"1\":\"WV\",\"2\":\"PUTNAM\",\"3\":\"83\"},{\"1\":\"WV\",\"2\":\"RALEIGH\",\"3\":\"98\"},{\"1\":\"WV\",\"2\":\"RANDOLPH\",\"3\":\"21\"},{\"1\":\"WV\",\"2\":\"RITCHIE\",\"3\":\"7\"},{\"1\":\"WV\",\"2\":\"ROANE\",\"3\":\"3\"},{\"1\":\"WV\",\"2\":\"SUMMERS\",\"3\":\"153\"},{\"1\":\"WV\",\"2\":\"TAYLOR\",\"3\":\"94\"},{\"1\":\"WV\",\"2\":\"TUCKER\",\"3\":\"2\"},{\"1\":\"WV\",\"2\":\"TYLER\",\"3\":\"2\"},{\"1\":\"WV\",\"2\":\"UPSHUR\",\"3\":\"5\"},{\"1\":\"WV\",\"2\":\"WAYNE\",\"3\":\"217\"},{\"1\":\"WV\",\"2\":\"WEBSTER\",\"3\":\"5\"},{\"1\":\"WV\",\"2\":\"WETZEL\",\"3\":\"9\"},{\"1\":\"WV\",\"2\":\"WIRT\",\"3\":\"7\"},{\"1\":\"WV\",\"2\":\"WOOD\",\"3\":\"108\"},{\"1\":\"WV\",\"2\":\"WYOMING\",\"3\":\"63\"},{\"1\":\"WV Total\",\"2\":\"/\",\"3\":\"3213\"},{\"1\":\"WY\",\"2\":\"ALBANY\",\"3\":\"90\"},{\"1\":\"WY\",\"2\":\"BIG HORN\",\"3\":\"70\"},{\"1\":\"WY\",\"2\":\"CAMPBELL\",\"3\":\"386\"},{\"1\":\"WY\",\"2\":\"CARBON\",\"3\":\"168\"},{\"1\":\"WY\",\"2\":\"CONVERSE\",\"3\":\"211\"},{\"1\":\"WY\",\"2\":\"CROOK\",\"3\":\"33\"},{\"1\":\"WY\",\"2\":\"FREMONT\",\"3\":\"42\"},{\"1\":\"WY\",\"2\":\"GOSHEN\",\"3\":\"244\"},{\"1\":\"WY\",\"2\":\"HOT SPRINGS\",\"3\":\"4\"},{\"1\":\"WY\",\"2\":\"JOHNSON\",\"3\":\"18\"},{\"1\":\"WY\",\"2\":\"LARAMIE\",\"3\":\"737\"},{\"1\":\"WY\",\"2\":\"LINCOLN\",\"3\":\"25\"},{\"1\":\"WY\",\"2\":\"NATRONA\",\"3\":\"92\"},{\"1\":\"WY\",\"2\":\"NIOBRARA\",\"3\":\"51\"},{\"1\":\"WY\",\"2\":\"PARK\",\"3\":\"29\"},{\"1\":\"WY\",\"2\":\"PLATTE\",\"3\":\"129\"},{\"1\":\"WY\",\"2\":\"SHERIDAN\",\"3\":\"252\"},{\"1\":\"WY\",\"2\":\"SUBLETTE\",\"3\":\"3\"},{\"1\":\"WY\",\"2\":\"SWEETWATER\",\"3\":\"196\"},{\"1\":\"WY\",\"2\":\"UINTA\",\"3\":\"49\"},{\"1\":\"WY\",\"2\":\"WASHAKIE\",\"3\":\"10\"},{\"1\":\"WY\",\"2\":\"WESTON\",\"3\":\"37\"},{\"1\":\"WY Total\",\"2\":\"/\",\"3\":\"2876\"},{\"1\":\"Grand Total\",\"2\":\"/\",\"3\":\"255432\"},{\"1\":\"CANADA\",\"2\":\"Canada\",\"3\":\"662\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nstr(data_clean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [2,985 × 3] (S3: tbl_df/tbl/data.frame)\n $ STATE : chr [1:2985] \"AE\" \"AE Total1\" \"AK\" \"AK\" ...\n $ COUNTY: chr [1:2985] \"APO\" \"/\" \"ANCHORAGE\" \"FAIRBANKS NORTH STAR\" ...\n $ TOTAL : num [1:2985] 2 2 7 2 3 2 1 88 103 102 ...\n```\n:::\n:::\n\n\n### Briefly describe the data\nThis dataset, which consists of 2,985 rows and 3 columns, captures the following information:\n\n- `STATE`: This is a character variable representing state abbreviations such as \"AE\", \"AK\".\n- `COUNTY`: This is a character variable indicating county names such as \"APO\", \"ANCHORAGE\".\n- `TOTAL`: This is a numerical variable that denotes the total number of employees in each county.\n\nFrom my understanding, the dataset provides information on employment numbers distributed across various counties in multiple US states.\n\n\n\n\n\nAre there any variables that require mutation to be usable in your analysis stream? For example, do you need to calculate new values in order to graph them? Can string values be represented numerically? Do you need to turn any variables into factors and reorder for ease of graphics and visualization?\n\nDocument your work here.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate total employment by state\ndata_clean <- data_clean %>% \n  group_by(STATE) %>% \n  mutate(total_state_employment = sum(TOTAL, na.rm = TRUE))\n\n# Convert state variable into factor\ndata_clean$STATE <- as.factor(data_clean$STATE)\n\n# Changing county names to title case\ndata_clean$COUNTY <- str_to_title(data_clean$COUNTY)\n\n# Checking the structure of our data frame after mutations\nhead(data_clean)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"STATE\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"COUNTY\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"TOTAL\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"total_state_employment\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"AE\",\"2\":\"Apo\",\"3\":\"2\",\"4\":\"2\"},{\"1\":\"AE Total1\",\"2\":\"/\",\"3\":\"2\",\"4\":\"2\"},{\"1\":\"AK\",\"2\":\"Anchorage\",\"3\":\"7\",\"4\":\"103\"},{\"1\":\"AK\",\"2\":\"Fairbanks North Star\",\"3\":\"2\",\"4\":\"103\"},{\"1\":\"AK\",\"2\":\"Juneau\",\"3\":\"3\",\"4\":\"103\"},{\"1\":\"AK\",\"2\":\"Matanuska-Susitna\",\"3\":\"2\",\"4\":\"103\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## Join Data\n\nBe sure to include a sanity check, and double-check that case count is correct!\n\n::: {.cell}\n\n```{.r .cell-code}\n# Creating a dataset for total state employment\nstate_totals <- data_clean %>%\n  group_by(STATE) %>%\n  summarise(total_state_employment = sum(TOTAL, na.rm = TRUE))\n\n# Creating a dataset for county-specific counts\ncounty_counts <- data_clean %>%\n  select(STATE, COUNTY, TOTAL)\n\n# Joining the datasets\njoined_data <- left_join(county_counts, state_totals, by = \"STATE\")\n\n# Checking the first few rows of the joined data\nhead(joined_data)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"STATE\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"COUNTY\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"TOTAL\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"total_state_employment\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"AE\",\"2\":\"Apo\",\"3\":\"2\",\"4\":\"2\"},{\"1\":\"AE Total1\",\"2\":\"/\",\"3\":\"2\",\"4\":\"2\"},{\"1\":\"AK\",\"2\":\"Anchorage\",\"3\":\"7\",\"4\":\"103\"},{\"1\":\"AK\",\"2\":\"Fairbanks North Star\",\"3\":\"2\",\"4\":\"103\"},{\"1\":\"AK\",\"2\":\"Juneau\",\"3\":\"3\",\"4\":\"103\"},{\"1\":\"AK\",\"2\":\"Matanuska-Susitna\",\"3\":\"2\",\"4\":\"103\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# Checking the structure of the joined data\nstr(joined_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ngropd_df [2,985 × 4] (S3: grouped_df/tbl_df/tbl/data.frame)\n $ STATE                 : Factor w/ 108 levels \"AE\",\"AE Total1\",..: 1 2 3 3 3 3 3 3 4 5 ...\n $ COUNTY                : chr [1:2985] \"Apo\" \"/\" \"Anchorage\" \"Fairbanks North Star\" ...\n $ TOTAL                 : num [1:2985] 2 2 7 2 3 2 1 88 103 102 ...\n $ total_state_employment: num [1:2985] 2 2 103 103 103 ...\n - attr(*, \"groups\")= tibble [108 × 2] (S3: tbl_df/tbl/data.frame)\n  ..$ STATE: Factor w/ 108 levels \"AE\",\"AE Total1\",..: 1 2 3 4 5 6 7 8 9 10 ...\n  ..$ .rows: list<int> [1:108] \n  .. ..$ : int 1\n  .. ..$ : int 2\n  .. ..$ : int [1:6] 3 4 5 6 7 8\n  .. ..$ : int 9\n  .. ..$ : int [1:67] 10 11 12 13 14 15 16 17 18 19 ...\n  .. ..$ : int 77\n  .. ..$ : int 78\n  .. ..$ : int 79\n  .. ..$ : int [1:72] 80 81 82 83 84 85 86 87 88 89 ...\n  .. ..$ : int 152\n  .. ..$ : int [1:15] 153 154 155 156 157 158 159 160 161 162 ...\n  .. ..$ : int 168\n  .. ..$ : int [1:55] 169 170 171 172 173 174 175 176 177 178 ...\n  .. ..$ : int 224\n  .. ..$ : int 2985\n  .. ..$ : int [1:57] 225 226 227 228 229 230 231 232 233 234 ...\n  .. ..$ : int 282\n  .. ..$ : int [1:8] 283 284 285 286 287 288 289 290\n  .. ..$ : int 291\n  .. ..$ : int 292\n  .. ..$ : int 293\n  .. ..$ : int [1:3] 294 295 296\n  .. ..$ : int 297\n  .. ..$ : int [1:67] 298 299 300 301 302 303 304 305 306 307 ...\n  .. ..$ : int 365\n  .. ..$ : int [1:152] 366 367 368 369 370 371 372 373 374 375 ...\n  .. ..$ : int 518\n  .. ..$ : int 2984\n  .. ..$ : int [1:3] 519 520 521\n  .. ..$ : int 522\n  .. ..$ : int [1:99] 523 524 525 526 527 528 529 530 531 532 ...\n  .. ..$ : int 622\n  .. ..$ : int [1:36] 623 624 625 626 627 628 629 630 631 632 ...\n  .. ..$ : int 659\n  .. ..$ : int [1:103] 660 661 662 663 664 665 666 667 668 669 ...\n  .. ..$ : int 763\n  .. ..$ : int [1:92] 764 765 766 767 768 769 770 771 772 773 ...\n  .. ..$ : int 856\n  .. ..$ : int [1:95] 857 858 859 860 861 862 863 864 865 866 ...\n  .. ..$ : int 952\n  .. ..$ : int [1:119] 953 954 955 956 957 958 959 960 961 962 ...\n  .. ..$ : int 1072\n  .. ..$ : int [1:63] 1073 1074 1075 1076 1077 1078 1079 1080 1081 1082 ...\n  .. ..$ : int 1136\n  .. ..$ : int [1:12] 1137 1138 1139 1140 1141 1142 1143 1144 1145 1146 ...\n  .. ..$ : int 1149\n  .. ..$ : int [1:24] 1150 1151 1152 1153 1154 1155 1156 1157 1158 1159 ...\n  .. ..$ : int 1174\n  .. ..$ : int [1:16] 1175 1176 1177 1178 1179 1180 1181 1182 1183 1184 ...\n  .. ..$ : int 1191\n  .. ..$ : int [1:78] 1192 1193 1194 1195 1196 1197 1198 1199 1200 1201 ...\n  .. ..$ : int 1270\n  .. ..$ : int [1:86] 1271 1272 1273 1274 1275 1276 1277 1278 1279 1280 ...\n  .. ..$ : int 1357\n  .. ..$ : int [1:115] 1358 1359 1360 1361 1362 1363 1364 1365 1366 1367 ...\n  .. ..$ : int 1473\n  .. ..$ : int [1:78] 1474 1475 1476 1477 1478 1479 1480 1481 1482 1483 ...\n  .. ..$ : int 1552\n  .. ..$ : int [1:53] 1553 1554 1555 1556 1557 1558 1559 1560 1561 1562 ...\n  .. ..$ : int 1606\n  .. ..$ : int [1:94] 1607 1608 1609 1610 1611 1612 1613 1614 1615 1616 ...\n  .. ..$ : int 1701\n  .. ..$ : int [1:49] 1702 1703 1704 1705 1706 1707 1708 1709 1710 1711 ...\n  .. ..$ : int 1751\n  .. ..$ : int [1:89] 1752 1753 1754 1755 1756 1757 1758 1759 1760 1761 ...\n  .. ..$ : int 1841\n  .. ..$ : int [1:10] 1842 1843 1844 1845 1846 1847 1848 1849 1850 1851\n  .. ..$ : int 1852\n  .. ..$ : int [1:21] 1853 1854 1855 1856 1857 1858 1859 1860 1861 1862 ...\n  .. ..$ : int 1874\n  .. ..$ : int [1:29] 1875 1876 1877 1878 1879 1880 1881 1882 1883 1884 ...\n  .. ..$ : int 1904\n  .. ..$ : int [1:12] 1905 1906 1907 1908 1909 1910 1911 1912 1913 1914 ...\n  .. ..$ : int 1917\n  .. ..$ : int [1:61] 1918 1919 1920 1921 1922 1923 1924 1925 1926 1927 ...\n  .. ..$ : int 1979\n  .. ..$ : int [1:88] 1980 1981 1982 1983 1984 1985 1986 1987 1988 1989 ...\n  .. ..$ : int 2068\n  .. ..$ : int [1:73] 2069 2070 2071 2072 2073 2074 2075 2076 2077 2078 ...\n  .. ..$ : int 2142\n  .. ..$ : int [1:33] 2143 2144 2145 2146 2147 2148 2149 2150 2151 2152 ...\n  .. ..$ : int 2176\n  .. ..$ : int [1:65] 2177 2178 2179 2180 2181 2182 2183 2184 2185 2186 ...\n  .. ..$ : int 2242\n  .. ..$ : int [1:5] 2243 2244 2245 2246 2247\n  .. ..$ : int 2248\n  .. ..$ : int [1:46] 2249 2250 2251 2252 2253 2254 2255 2256 2257 2258 ...\n  .. ..$ : int 2295\n  .. ..$ : int [1:52] 2296 2297 2298 2299 2300 2301 2302 2303 2304 2305 ...\n  .. ..$ : int 2348\n  .. ..$ : int [1:91] 2349 2350 2351 2352 2353 2354 2355 2356 2357 2358 ...\n  .. ..$ : int 2440\n  .. ..$ : int [1:221] 2441 2442 2443 2444 2445 2446 2447 2448 2449 2450 ...\n  .. ..$ : int 2662\n  .. ..$ : int [1:25] 2663 2664 2665 2666 2667 2668 2669 2670 2671 2672 ...\n  .. ..$ : int 2688\n  .. ..$ : int [1:92] 2689 2690 2691 2692 2693 2694 2695 2696 2697 2698 ...\n  .. ..$ : int 2781\n  .. ..$ : int [1:14] 2782 2783 2784 2785 2786 2787 2788 2789 2790 2791 ...\n  .. .. [list output truncated]\n  .. ..@ ptype: int(0) \n  ..- attr(*, \".drop\")= logi TRUE\n```\n:::\n:::\n\nIn this code, I create two datasets, `state_totals` and `county_counts`, from the original `data_clean`. `state_totals` contains total employment by state and `county_counts` provides employee counts by county. I then join these datasets on the `STATE` column to form `joined_data`, and check the output using `head` and `str` functions.\n\n### Visualization\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Subset to include only the top 10 states with the highest total employment\ntop_states <- joined_data %>%\n  group_by(STATE) %>%\n  summarise(total_state_employment = sum(total_state_employment)) %>%\n  arrange(desc(total_state_employment)) %>%\n  slice(1:10)\n\n# Filter the original data to include only the top states\nfiltered_data <- joined_data %>% \n  filter(STATE %in% top_states$STATE)\n\n# Plotting the total state employment for the top 10 states\nggplot(filtered_data, aes(x = reorder(STATE, total_state_employment), y = total_state_employment)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\") +\n  scale_y_continuous(labels = comma) +  # Use comma formatting for the y axis\n  coord_flip() +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, size = 8)) +\n  labs(title = \"Total Employment per State (Top 10)\",\n       x = \"State\",\n       y = \"Total Employment\")\n```\n\n::: {.cell-output-display}\n![](Zhongyue_Linchallenge8_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Zhongyue_Linchallenge8_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}